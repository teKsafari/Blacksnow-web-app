<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blacksnow</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Inter:wght@400;500;600;700&display=swap');

    /* ── GLOBAL SCROLLBAR ── */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(0, 198, 255, 0.2);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 198, 255, 0.4);
    }

    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(0, 198, 255, 0.2) rgba(0, 0, 0, 0.1);
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    body,
    html {
      margin: 0;
      padding: 0;
      font-family: 'Share Tech Mono', monospace;
      background: radial-gradient(circle at 10% 20%, rgb(20, 30, 48) 0%, rgb(12, 20, 40) 90%);
      color: #e0e0e0;
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: -20%;
      left: -10%;
      width: 50vw;
      height: 50vw;
      background: radial-gradient(circle, rgba(0, 255, 255, 0.12), transparent 65%);
      z-index: 0;
      pointer-events: none;
      filter: blur(60px);
    }

    body::after {
      content: '';
      position: fixed;
      bottom: -15%;
      right: -5%;
      width: 40vw;
      height: 40vw;
      background: radial-gradient(circle, rgba(70, 0, 255, 0.1), transparent 65%);
      z-index: 0;
      pointer-events: none;
      filter: blur(70px);
    }

    /* ── LAYOUT ── */
    .container {
      flex: 1;
      display: flex;
      flex-direction: row;
      overflow: hidden;
      padding: 0;
      z-index: 2;
      position: relative;
    }

    #left {
      width: 440px;
      min-width: 300px;
      height: 100%;
      background: rgba(255, 255, 255, 0.04);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-right: 1px solid rgba(255, 255, 255, 0.09);
      padding: 24px 20px;
      display: flex;
      flex-direction: column;
      box-shadow: 0 8px 40px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.06);
    }

    #resizer {
      width: 8px;
      cursor: col-resize;
      background: rgba(255, 255, 255, 0.02);
      transition: background 0.2s;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    #resizer:hover, #resizer.dragging {
      background: rgba(0, 198, 255, 0.15);
    }

    #resizer::after {
      content: "";
      width: 2px;
      height: 40px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 1px;
    }



    /* ── MODE SWITCHER ── */
    .mode-switcher {
      display: flex;
      gap: 0;
      background: rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 10px;
      padding: 3px;
      margin-bottom: 18px;
      position: relative;
    }

    .mode-btn {
      flex: 1;
      padding: 8px 0;
      border: none;
      border-radius: 7px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-size: 0.82em;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      transition: all 0.25s ease;
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      background: transparent;
      color: rgba(255, 255, 255, 0.45);
    }

    .mode-btn svg {
      opacity: 0.6;
      transition: opacity 0.2s;
    }

    .mode-btn.active {
      background: linear-gradient(135deg, rgba(0, 198, 255, 0.2), rgba(0, 114, 255, 0.25));
      color: #fff;
      box-shadow: 0 2px 12px rgba(0, 114, 255, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(0, 198, 255, 0.25);
    }

    .mode-btn.active svg {
      opacity: 1;
    }

    .mode-btn:hover:not(.active) {
      color: rgba(255, 255, 255, 0.7);
      background: rgba(255, 255, 255, 0.05);
    }

    /* ── SECTION HEADERS ── */
    #left h3 {
      text-align: left;
      font-size: 0.78em;
      margin: 14px 0 8px 0;
      color: rgba(0, 255, 255, 0.7);
      text-transform: uppercase;
      letter-spacing: 2px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.07);
      padding-bottom: 5px;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
    }

    #left h3:first-child {
      margin-top: 0;
    }

    /* ── SETUP ROW ── */
    #houseIdInput {
      flex: 1;
      padding: 9px 12px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      outline: none;
      background: rgba(0, 0, 0, 0.35);
      color: #fff;
      font-family: inherit;
      transition: 0.3s;
      font-size: 0.9em;
    }

    #houseIdInput:focus {
      border-color: #0ff;
      background: rgba(0, 0, 0, 0.55);
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.18);
    }

    #houseIdInput::placeholder {
      color: rgba(255, 255, 255, 0.3);
    }

    .setup-row {
      display: flex;
      gap: 8px;
      margin-bottom: 14px;
    }

    .setup-row button {
      width: auto;
      padding: 9px 13px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.06);
      color: #fff;
      cursor: pointer;
      transition: 0.2s;
      font-family: inherit;
      font-size: 0.85em;
      white-space: nowrap;
    }

    .setup-row button:hover {
      background: rgba(255, 255, 255, 0.14);
      border-color: rgba(255, 255, 255, 0.25);
    }

    #pasteBtn {
      padding: 9px 12px;
      display: flex;
      align-items: center;
    }

    /* ── BLOCK ACTIONS ── */
    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 12px;
    }

    .actions button {
      padding: 5px 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 2px;
      background: rgba(255, 255, 255, 0.05);
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      transition: all 0.18s;
      font-family: 'Inter', sans-serif;
      font-size: 0.78em;
      font-weight: 500;
      letter-spacing: 0.4px;
      white-space: nowrap;
    }

    .actions button:hover {
      background: rgba(0, 255, 255, 0.12);
      border-color: rgba(0, 255, 255, 0.45);
      color: #0ff;
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.12);
    }

    .actions button:active {
      transform: scale(0.96);
    }

    /* ── WORKSPACE ── */
    .workspace {
      flex: 1;
      background: rgba(0, 0, 0, 0.22);
      border-radius: 10px;
      padding: 10px;
      overflow: auto;
      display: flex;
      flex-direction: column;
      gap: 7px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: inset 0 0 18px rgba(0, 0, 0, 0.5);
      min-height: 120px;
    }

    .workspace-empty {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(255, 255, 255, 0.18);
      font-size: 0.82em;
      letter-spacing: 1px;
      text-align: center;
      pointer-events: none;
      font-family: 'Inter', sans-serif;
    }

    .block {
      background: rgba(255, 255, 255, 0.07);
      backdrop-filter: blur(4px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-left: 3px solid #0ff;
      border-radius: 8px;
      padding: 9px 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 7px;
      align-items: center;
      cursor: grab;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
      transition: all 0.2s;
      position: relative;
    }

    .block:hover {
      background: rgba(255, 255, 255, 0.13);
      transform: translateY(-2px);
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.45);
    }

    .block.drag-over {
      border-color: #0ff;
      background: rgba(0, 255, 255, 0.08);
    }

    .block strong {
      color: #0ff;
      margin-right: 3px;
      font-size: 0.88em;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .block select,
    .block input[type=range],
    .block input[type=number] {
      border-radius: 5px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      padding: 3px 7px;
      background: rgba(0, 0, 0, 0.45);
      color: #fff;
      font-family: inherit;
      outline: none;
      font-size: 0.85em;
    }

    .block input[type=range] {
      -webkit-appearance: none;
      width: 95px;
      background: transparent;
    }

    .block input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      background: #0ff;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      cursor: pointer;
      margin-top: -4px;
      box-shadow: 0 0 5px #0ff;
    }

    .block input[type=range]::-webkit-slider-runnable-track {
      background: rgba(255, 255, 255, 0.2);
      height: 4px;
      border-radius: 2px;
    }

    .block .block-del {
      margin-left: auto;
      background: transparent;
      border: 1px solid rgba(255, 60, 60, 0.35);
      color: #ff5555;
      border-radius: 4px;
      padding: 2px 8px;
      cursor: pointer;
      font-size: 0.8em;
      transition: 0.15s;
    }

    .block .block-del:hover {
      background: rgba(255, 0, 0, 0.2);
      border-color: #ff5555;
    }

    .ws-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 14px 0 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.07);
      padding-bottom: 5px;
    }

    .ws-header h3 {
      margin: 0;
      border: none;
      padding: 0;
    }

    /* Right-side convert button */
    #convertBtn {
      padding: 5px 11px;
      border-radius: 6px;
      border: 1px solid rgba(0, 255, 255, 0.25);
      background: rgba(0, 255, 255, 0.07);
      color: #0ff;
      font-family: inherit;
      font-size: 0.75em;
      cursor: pointer;
      transition: 0.2s;
      letter-spacing: 0.5px;
    }

    #convertBtn:hover {
      background: rgba(0, 255, 255, 0.18);
    }

    /* ── RUN BUTTON ── */
    .run-btn {
      padding: 9px 18px;
      border: none;
      border-radius: 8px;
      background: linear-gradient(90deg, #00c6ff 0%, #0072ff 100%);
      color: #fff;
      font-weight: 700;
      font-size: 0.88em;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      box-shadow: 0 0 14px rgba(0, 114, 255, 0.4);
      transition: all 0.25s;
      font-family: 'Inter', sans-serif;
      display: flex;
      align-items: center;
      gap: 7px;
    }

    .run-btn:hover {
      box-shadow: 0 0 22px rgba(0, 114, 255, 0.65);
      transform: translateY(-1px);
    }

    .run-btn:active {
      transform: translateY(0);
      box-shadow: 0 0 10px rgba(0, 114, 255, 0.4);
    }

    /* ── OUTPUT TERMINAL ── */
    .output-panel {
      margin-top: 14px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      overflow: hidden;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      background: rgba(0, 0, 0, 0.5);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.04);
    }

    .output-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.04);
      border-bottom: 1px solid rgba(255, 255, 255, 0.07);
      flex-shrink: 0;
    }

    .output-header-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .output-dots {
      display: flex;
      gap: 5px;
    }

    .output-dot {
      width: 9px;
      height: 9px;
      border-radius: 50%;
    }

    .output-dot.red {
      background: rgba(255, 95, 87, 0.7);
    }

    .output-dot.yellow {
      background: rgba(255, 189, 46, 0.7);
    }

    .output-dot.green {
      background: rgba(40, 201, 64, 0.7);
    }

    .output-title {
      font-family: 'Inter', sans-serif;
      font-size: 0.7em;
      font-weight: 600;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: rgba(255, 255, 255, 0.3);
    }

    .output-clear-btn {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      color: rgba(255, 255, 255, 0.3);
      font-family: 'Inter', sans-serif;
      font-size: 0.68em;
      font-weight: 500;
      letter-spacing: 0.5px;
      padding: 2px 8px;
      cursor: pointer;
      transition: all 0.15s;
      text-transform: uppercase;
    }

    .output-clear-btn:hover {
      border-color: rgba(255, 255, 255, 0.25);
      color: rgba(255, 255, 255, 0.6);
    }

    #log {
      background: transparent;
      color: rgba(180, 255, 180, 0.85);
      font-size: 11.5px;
      padding: 7px 14px;
      height: 58px;
      overflow-y: auto;
      font-family: 'Share Tech Mono', monospace;
      line-height: 1.7;
      flex-shrink: 0;
    }

    .log-line {
      display: flex;
      gap: 10px;
      align-items: baseline;
    }

    .log-ts {
      color: rgba(255, 255, 255, 0.2);
      font-size: 0.85em;
      flex-shrink: 0;
      user-select: none;
    }

    .log-line .log-err {
      color: #ff6b6b;
    }

    .log-line .log-ok {
      color: #5dfc82;
    }

    .log-line .log-info {
      color: #4dd8ff;
    }

    /* ── MODE PANELS ── */
    #blocksMode,
    #codeMode {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-height: 0;
    }

    .hidden {
      display: none !important;
    }

    /* ── CODE MODE ── */
    #codePanel {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-height: 0;
    }

    #monacoWrapper {
      flex: 1;
      min-height: 0;
      position: relative;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.6);
    }

    #monacoContainer {
      width: 100%;
      height: 100%;
    }

    .editor-controls {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 10;
    }

    .editor-btn {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      background: rgba(20, 30, 48, 0.8);
      backdrop-filter: blur(4px);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .editor-btn:hover {
      background: rgba(0, 198, 255, 0.2);
      border-color: #00c6ff;
      box-shadow: 0 0 10px rgba(0, 198, 255, 0.3);
    }

    .editor-btn.run {
      color: #0ff;
    }

    .editor-btn.clear {
      color: rgba(255, 255, 255, 0.5);
    }

    .code-run-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 12px;
    }



    /* API pill badges */
    .api-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 10px;
    }

    .api-pill {
      padding: 3px 9px;
      border-radius: 20px;
      background: rgba(0, 255, 255, 0.08);
      border: 1px solid rgba(0, 255, 255, 0.2);
      color: #0ff;
      font-size: 0.72em;
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 0.3px;
      cursor: default;
      transition: background 0.2s;
    }

    .api-pill:hover {
      background: rgba(0, 255, 255, 0.16);
    }

    /* ── RIGHT PANEL (iframe sim) ── */
    #right {
      flex: 1;
      background: rgba(255, 255, 255, 0.02);
      backdrop-filter: blur(10px);
      overflow: hidden;
      box-shadow: 0 8px 40px rgba(0, 0, 0, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.04);
      z-index: 1;
    }

    #right iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* ── RESPONSIVE ── */
    @media(max-width: 960px) {
      .container {
        flex-direction: column;
        padding: 0;
        gap: 0;
        height: 100%;
      }

      #left {
        width: 100%;
        height: 50%; /* 50/50 Initial Split */
        margin: 0;
        border-radius: 0;
        border: none;
      }

      #resizer {
        width: 100%;
        height: 12px;
        cursor: row-resize;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      #resizer::after {
        width: 40px;
        height: 2px;
      }

      #right {
        flex: none;
        width: 100%;
        height: 50%; /* 50/50 Initial Split */
        border-radius: 0;
        overflow: hidden;
      }

      body,
      html {
        overflow: hidden;
        height: 100%;
      }

      #setBtn {
        display: none;
      }

      /* Mobile layout ordering */
      #houseIdRow { order: 1; }
      .mode-switcher { order: 2; }
      #blocksMode, #codeMode { 
        order: 3; 
        flex: 1; 
        min-height: 300px;
      }
      .output-panel { 
        order: 4; 
        margin-top: 14px;
        margin-bottom: 0;
        flex-shrink: 0;
      }

      #left {
        display: flex;
        flex-direction: column;
        overflow-y: auto; /* Allow scrolling for the whole panel */
      }

      .help-footer-btn {
        display: none !important;
      }
    }



    /* ── RUNNING ANIMATION ── */
    @keyframes pulse-glow {
      0% {
        box-shadow: 0 0 14px rgba(0, 114, 255, 0.4);
      }

      50% {
        box-shadow: 0 0 28px rgba(0, 198, 255, 0.7);
      }

      100% {
        box-shadow: 0 0 14px rgba(0, 114, 255, 0.4);
      }
    }

    .run-btn.running {
      animation: pulse-glow 1s ease-in-out infinite;
    }

    /* ── HELP DRAWER ── */
    #helpPanel {
      position: relative;
      width: 100%;
      background: rgba(0, 198, 255, 0.03);
      border: 1px solid rgba(0, 198, 255, 0.1);
      border-radius: 12px;
      margin-bottom: 12px;
      z-index: 50;
      display: none;
      flex-direction: column;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    #helpPanel.active {
      display: flex;
    }

    .help-header {
      padding: 12px 16px;
      background: rgba(255, 255, 255, 0.02);
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .help-header h4 {
      margin: 0;
      font-family: 'Inter', sans-serif;
      font-size: 0.8em;
      font-weight: 700;
      color: #00c6ff;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .help-close {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.6);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      transition: 0.2s;
    }

    .help-close:hover {
      background: rgba(255, 60, 60, 0.15);
      color: #ff5555;
    }

    .help-content {
      padding: 14px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 8px;
    }

    .help-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.03);
      border-radius: 8px;
    }

    .help-cmd {
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.8em;
      color: #00c6ff;
    }

    .help-desc {
      font-family: 'Inter', sans-serif;
      font-size: 0.7em;
      color: rgba(255, 255, 255, 0.35);
    }

    .help-footer {
      padding: 10px 16px;
      background: rgba(0, 0, 0, 0.15);
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .help-info {
      font-size: 0.65em;
      color: rgba(255, 255, 255, 0.25);
      font-family: 'Inter', sans-serif;
    }

    .help-footer-btn {
      padding: 6px 14px;
      border-radius: 6px;
      background: rgba(0, 198, 255, 0.1);
      border: 1px solid rgba(0, 198, 255, 0.2);
      color: #00c6ff;
      font-family: 'Inter', sans-serif;
      font-size: 0.7em;
      font-weight: 700;
      cursor: pointer;
      transition: 0.2s;
    }

    .help-footer-btn:hover {
      background: rgba(0, 198, 255, 0.2);
    }

    .view-help-btn {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.6);
      padding: 5px 12px;
      border-radius: 20px;
      font-family: 'Inter', sans-serif;
      font-size: 0.72em;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.25s ease;
    }

    .view-help-btn::before {
      content: "?";
      width: 16px;
      height: 16px;
      background: rgba(0, 198, 255, 0.2);
      color: #00c6ff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
    }

    .view-help-btn:hover {
      background: rgba(0, 198, 255, 0.1);
      border-color: rgba(0, 198, 255, 0.4);
      color: #00c6ff;
      box-shadow: 0 0 15px rgba(0, 198, 255, 0.15);
    }
  </style>
</head>

<body>

  <div class="container">
    <div id="left">
      <!-- House ID Row -->
      <div id="houseIdRow" class="setup-row" style="order: 1;">
        <input id="houseIdInput" placeholder="Enter House ID…" oninput="setupHouse()">
        <button id="pasteBtn" onclick="pasteHouseId()" title="Paste from Clipboard">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z" />
          </svg>
        </button>
      </div>

      <!-- Mode Switcher -->
      <div class="mode-switcher" role="tablist" style="order: 2;">
        <button id="btnBlocks" class="mode-btn active" onclick="switchMode('blocks')" role="tab" aria-selected="true" aria-controls="blocksMode">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <rect x="2" y="2" width="9" height="9" rx="2" /><rect x="13" y="2" width="9" height="9" rx="2" />
            <rect x="2" y="13" width="9" height="9" rx="2" /><rect x="13" y="13" width="9" height="9" rx="2" />
          </svg>
          Blocks
        </button>
        <button id="btnCode" class="mode-btn" onclick="switchMode('code')" role="tab" aria-selected="false" aria-controls="codeMode">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8.293 6.293L2.586 12l5.707 5.707 1.414-1.414L5.414 12l4.293-4.293zm7.414 0l-1.414 1.414L18.586 12l-4.293 4.293 1.414 1.414L21.414 12z" />
          </svg>
          Code
        </button>
      </div>

      <!-- BLOCKS MODE -->
      <div id="blocksMode" style="order: 3;">
        <h3>Actions</h3>
        <div class="actions">
          <button onclick="addBlock('on')">Light On</button>
          <button onclick="addBlock('off')">Light Off</button>
          <button onclick="addBlock('toggle')">Toggle</button>
          <button onclick="addBlock('fan')">Fan</button>
          <button onclick="addBlock('alarm')">Alarm</button>
          <button onclick="addBlock('blinds')">Blinds</button>
          <button onclick="addBlock('thermostat')">Thermostat</button>
          <button onclick="addBlock('wait')">Wait</button>
        </div>
        <div class="ws-header">
          <h3>Workspace</h3>
          <div style="display:flex;gap:7px;align-items:center;">
            <button id="convertBtn" onclick="convertToCode()" title="Convert blocks to JS code">⇄ To Code</button>
            <button id="runBtn" class="run-btn" onclick="runProgram()">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21" /></svg>
              Run
            </button>
          </div>
        </div>
        <div id="workspace" class="workspace">
          <div class="workspace-empty" id="wsEmpty">Drop blocks here to build your program…</div>
        </div>
      </div>

      <!-- CODE MODE -->
      <div id="codeMode" class="hidden" style="order: 3;">
        <div id="codePanel">
          <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <h3 style="margin:0; border:none;">Source Code</h3>
            <button id="viewHelpBtn" class="view-help-btn" onclick="toggleHelp()">View Functions</button>
          </div>
          
          <!-- Help Drawer (Pushes code below) -->
          <div id="helpPanel">
            <div class="help-header">
              <h4>Quick Reference</h4>
              <button class="help-close" onclick="toggleHelp()">×</button>
            </div>
            <div class="help-content">
              <div class="help-item"><div class="help-cmd">on(room)</div><div class="help-desc">Light ON</div></div>
              <div class="help-item"><div class="help-cmd">off(room)</div><div class="help-desc">Light OFF</div></div>
              <div class="help-item"><div class="help-cmd">toggle(room)</div><div class="help-desc">Toggle</div></div>
              <div class="help-item"><div class="help-cmd">fan(stat)</div><div class="help-desc">ON/OFF</div></div>
              <div class="help-item"><div class="help-cmd">alarm(stat)</div><div class="help-desc">Armed</div></div>
              <div class="help-item"><div class="help-cmd">wait(sec)</div><div class="help-desc">Delay</div></div>
              <div class="help-item"><div class="help-cmd">blinds(r,%)</div><div class="help-desc">Height</div></div>
              <div class="help-item"><div class="help-cmd">thermo(m,t)</div><div class="help-desc">HVAC</div></div>
            </div>
            <div class="help-footer">
              <div class="help-info">Rooms: living, bedroom, kitchen, outdoor</div>
              <button class="help-footer-btn" onclick="toggleHelp()">Close</button>
            </div>
          </div>

          <div id="monacoWrapper">
            <div id="monacoContainer"></div>
            <div class="editor-controls">
              <button id="codeRunBtn" class="editor-btn run" onclick="runCode()" title="Run Code (Ctrl+Enter)">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><polygon points="5,3 19,12 5,21" /></svg>
              </button>
              <button class="editor-btn clear" onclick="clearCode()" title="Clear Contents">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" /></svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Shared Output Panel -->
      <div class="output-panel" style="order: 4;">
        <div class="output-header">
          <div class="output-header-left">
            <div class="output-dots">
              <div class="output-dot red"></div><div class="output-dot yellow"></div><div class="output-dot green"></div>
            </div>
            <span class="output-title">Output</span>
          </div>
          <button class="output-clear-btn" onclick="clearLog()">Clear</button>
        </div>
        <div id="log"></div>
      </div>
    </div>

    <div id="resizer"></div>

    <div id="right">
      <iframe src="https://muqsit.io/labs/smart-house" title="Blacksnow Simulation"></iframe>
    </div>
  </div>



  <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.46.0/min/vs/loader.js"></script>

  <script>
    const BASE_URL = "https://muqsit.io/api/house";
    let HOUSE_ID = "";
    let program = [];
    let dragIndex = null;
    let monacoEditor = null;

    const rooms = ["living", "bedroom", "kitchen", "outdoor"];
    const blindsRooms = ["living", "bedroom"];
    const thermostatModes = ["cooling", "heating", "off"];
    const blockInputs = {
      on: ["room"], off: ["room"], toggle: ["room"],
      fan: ["state"], alarm: ["state"], door: ["state"],
      blinds: ["room", "percentage"], thermostat: ["mode", "target"], wait: ["seconds"]
    };

    function setupHouse() {
      HOUSE_ID = document.getElementById("houseIdInput").value.trim();
    }

    async function pasteHouseId() {
      try {
        const text = await navigator.clipboard.readText();
        document.getElementById("houseIdInput").value = text;
        setupHouse();
        logMessage("Pasted House ID ✓", "info");
      } catch (e) { logMessage("Paste failed: " + e, "err"); }
    }

    function _ts() {
      const n = new Date();
      return [n.getHours(), n.getMinutes(), n.getSeconds()].map(v => String(v).padStart(2, '0')).join(':');
    }

    function logMessage(msg, type = "ok") {
      const log = document.getElementById("log");
      const row = document.createElement("div");
      row.className = "log-line";
      const ts = document.createElement("span");
      ts.className = "log-ts"; ts.textContent = _ts();
      const text = document.createElement("span");
      text.className = type === "err" ? "log-err" : type === "info" ? "log-info" : "log-ok";
      text.textContent = msg;
      row.appendChild(ts); row.appendChild(text);
      log.appendChild(row); log.scrollTop = log.scrollHeight;
    }

    function clearLog() { document.getElementById("log").innerHTML = ""; }

    function switchMode(mode) {
      const blocksPanel = document.getElementById("blocksMode");
      const codePanel = document.getElementById("codeMode");
      const btnBlocks = document.getElementById("btnBlocks");
      const btnCode = document.getElementById("btnCode");

      if (mode === "blocks") {
        blocksPanel.classList.remove("hidden"); codePanel.classList.add("hidden");
        btnBlocks.classList.add("active"); btnCode.classList.remove("active");
      } else {
        codePanel.classList.remove("hidden"); blocksPanel.classList.add("hidden");
        btnCode.classList.add("active"); btnBlocks.classList.remove("active");
        if (monacoEditor) setTimeout(() => monacoEditor.layout(), 50);
      }
    }

    function addBlock(action) {
      const block = { action, params: {} };
      if (blockInputs[action]) blockInputs[action].forEach(p => block.params[p] = "");
      program.push(block);
      renderWorkspace();
    }

    function renderWorkspace() {
      const ws = document.getElementById("workspace");
      ws.innerHTML = "";
      if (program.length === 0) {
        ws.innerHTML = '<div class="workspace-empty" id="wsEmpty">Drop blocks here to build your program…</div>';
        return;
      }
      program.forEach((block, index) => {
        const div = document.createElement("div");
        div.className = "block"; div.draggable = true;
        div.ondragstart = () => dragIndex = index;
        div.ondragover = e => { e.preventDefault(); div.classList.add("drag-over"); };
        div.ondragleave = () => div.classList.remove("drag-over");
        div.ondrop = () => { div.classList.remove("drag-over"); reorderBlocks(index); };

        const actionLabel = { on: "Light On", off: "Light Off", toggle: "Toggle", fan: "Fan", alarm: "Alarm", blinds: "Blinds", thermostat: "Thermostat", wait: "Wait" };
        let html = `<strong>${actionLabel[block.action] || block.action}</strong>`;

        if (["on", "off", "toggle"].includes(block.action)) {
          html += `<select onchange="updateParam(${index},'room',this.value)">
            <option value="" ${block.params.room === "" ? 'selected' : ''}>Choose room</option>
            ${rooms.map(r => `<option value="${r}" ${block.params.room === r ? 'selected' : ''}>${r}</option>`).join("")}
          </select>`;
        }
        if (["fan", "alarm"].includes(block.action)) {
          html += `<select onchange="updateParam(${index},'state',this.value)">
            <option value="" ${block.params.state === "" ? 'selected' : ''}>Choose state</option>
            <option value="on" ${block.params.state === 'on' ? 'selected' : ''}>on</option>
            <option value="off" ${block.params.state === 'off' ? 'selected' : ''}>off</option>
          </select>`;
        }
        if (block.action === "blinds") {
          html += `<select onchange="updateParam(${index},'room',this.value)">
            <option value="" ${block.params.room === "" ? 'selected' : ''}>Choose room</option>
            ${blindsRooms.map(r => `<option value="${r}" ${block.params.room === r ? 'selected' : ''}>${r}</option>`).join("")}
          </select>`;
          const val = block.params.percentage !== "" ? block.params.percentage : 50;
          html += `<input type="range" min="0" max="100" value="${val}" oninput="updateParam(${index},'percentage',this.value)"><span>${val}%</span>`;
        }
        if (block.action === "thermostat") {
          html += `<select onchange="updateParam(${index},'mode',this.value)">
            <option value="" ${block.params.mode === "" ? 'selected' : ''}>Choose mode</option>
            ${thermostatModes.map(m => `<option value="${m}" ${block.params.mode === m ? 'selected' : ''}>${m}</option>`).join("")}
          </select>`;
          const val = block.params.target !== "" ? block.params.target : 65;
          html += `<input type="range" min="60" max="70" value="${val}" oninput="updateParam(${index},'target',this.value)"><span>${val}°</span>`;
        }
        if (block.action === "wait") {
          const s = block.params.seconds !== undefined && block.params.seconds !== "" ? block.params.seconds : "";
          html += `<input type="number" min="0" placeholder="1" style="width:55px;" value="${s}" oninput="updateParam(${index},'seconds',this.value)"> s`;
        }
        html += `<button class="block-del" onclick="removeBlock(${index})">✕</button>`;
        div.innerHTML = html; ws.appendChild(div);
      });
    }

    function reorderBlocks(targetIndex) {
      if (dragIndex === null || dragIndex === targetIndex) return;
      const moved = program.splice(dragIndex, 1)[0];
      program.splice(targetIndex, 0, moved);
      dragIndex = null; renderWorkspace();
    }

    function updateParam(index, key, value) { program[index].params[key] = value; renderWorkspace(); }
    function removeBlock(index) { program.splice(index, 1); renderWorkspace(); }

    async function apiCall(action, params) {
      if (!HOUSE_ID) throw new Error("House ID not set.");
      const res = await fetch(BASE_URL, {
        method: "POST", headers: { "Content-Type": "application/json", "X-House-Id": HOUSE_ID },
        body: JSON.stringify({ action, params })
      });
      return await res.json();
    }

    async function executeBlock(block) {
      if (block.params.room) validateRoom(block.params.room);
      switch (block.action) {
        case "on": return apiCall("setLight", { room: block.params.room, on: true });
        case "off": return apiCall("setLight", { room: block.params.room, on: false });
        case "toggle": return apiCall("toggleLight", { room: block.params.room });
        case "fan": return apiCall("setFan", { on: block.params.state === 'on' });
        case "alarm": return apiCall("setAlarm", { on: block.params.state === 'on' });
        case "blinds": return apiCall("setBlinds", { room: block.params.room, percentage: Number(block.params.percentage) });
        case "thermostat": 
          if (block.params.mode && !thermostatModes.includes(block.params.mode)) throw new Error(`Invalid mode: ${block.params.mode}`);
          return apiCall("setThermostat", { mode: block.params.mode, target: Number(block.params.target) });
        case "wait": return new Promise(r => setTimeout(r, Number(block.params.seconds) * 1000));
      }
    }

    function _fmt(r, action, params) {
      if (!r || !r.success) return r ? (r.error || "error") : "no response";
      const s = r.state;
      if (!s) return "ok";
      switch (action) {
        case "setLight":    return `${params.room} light → ${s.lights?.[params.room] ? "on" : "off"}`;
        case "toggleLight": return `${params.room} light → ${s.lights?.[params.room] ? "on" : "off"}`;
        case "setFan":      return `fan → ${s.fan ? "on" : "off"}`;
        case "setAlarm":    return `alarm → ${s.alarm ? "armed" : "disarmed"}`;
        case "setLock":     return `door → ${s.door?.open ? "open" : "closed"}`;
        case "setBlinds":   return `blinds[${params.room}] → ${s.blinds?.[params.room]}%`;
        case "setThermostat": return `thermostat → ${s.thermostat?.mode} / ${s.thermostat?.target}°`;
        default:            return "ok";
      }
    }

    async function runProgram() {
      if (program.length === 0) return;
      clearLog(); logMessage("Running program…", "info");
      for (let i = 0; i < program.length; i++) {
        const b = program[i];
        logMessage(`Step ${i + 1}: ${b.action}`, "info");
        try {
          const res = await executeBlock(b);
          if (res) {
            const act = (b.action === 'on' || b.action === 'off') ? 'setLight' : b.action === 'toggle' ? 'toggleLight' : b.action === 'fan' ? 'setFan' : b.action === 'alarm' ? 'setAlarm' : b.action === 'blinds' ? 'setBlinds' : 'setThermostat';
            logMessage(`  ✓ ${_fmt(res, act, b.params)}`);
          }
        } catch (e) {
          logMessage(`  ✗ Error: ${e.message}`, "err");
          break;
        }
      }
      logMessage("Program finished.", "ok");
    }

    let _queue = [];
    function _enqueue(label, task) { logMessage(label, "info"); _queue.push(task); }
    async function _drainQueue() { for (const task of _queue) { await task(); } }

    function setup(id) { HOUSE_ID = String(id).trim(); document.getElementById("houseIdInput").value = id; logMessage(`House ID → "${id}"`, "info"); }

    function validateRoom(room) {
      if (!rooms.includes(room)) {
        throw new Error(`Invalid room: "${room}". Allowed: ${rooms.join(", ")}`);
      }
    }

    // ── Short-form aliases ──
    function on(room)       { validateRoom(room); _enqueue(`on("${room}")`,       () => apiCall("setLight",     { room, on: true       }).then(r => logMessage(`  ✓ ${_fmt(r, "setLight",     { room })}`)));}
    function off(room)      { validateRoom(room); _enqueue(`off("${room}")`,      () => apiCall("setLight",     { room, on: false      }).then(r => logMessage(`  ✓ ${_fmt(r, "setLight",     { room })}`)));}
    function toggle(room)   { validateRoom(room); _enqueue(`toggle("${room}")`,   () => apiCall("toggleLight",  { room                }).then(r => logMessage(`  ✓ ${_fmt(r, "toggleLight",  { room })}`)));}
    function fan(state)     { _enqueue(`fan(${state})`,        () => apiCall("setFan",       { on: Boolean(state)   }).then(r => logMessage(`  ✓ ${_fmt(r, "setFan",       {})}`)));}
    function alarm(state)   { _enqueue(`alarm(${state})`,      () => apiCall("setAlarm",     { on: Boolean(state)   }).then(r => logMessage(`  ✓ ${_fmt(r, "setAlarm",     {})}`)));}
    function blinds(room, pct) { validateRoom(room); _enqueue(`blinds("${room}", ${pct})`, () => apiCall("setBlinds", { room, percentage: pct }).then(r => logMessage(`  ✓ ${_fmt(r, "setBlinds",   { room })}`)));}
    function thermostat(mode, target) { 
      if (!thermostatModes.includes(mode)) throw new Error(`Invalid mode: "${mode}". Allowed: ${thermostatModes.join(", ")}`);
      _enqueue(`thermostat("${mode}", ${target})`, () => apiCall("setThermostat", { mode, target }).then(r => logMessage(`  ✓ ${_fmt(r, "setThermostat", { mode, target })}`)));
    }
    function wait(s) { _enqueue(`wait(${s}s)`, () => new Promise(r => setTimeout(r, s * 1000))); }

    // ── Long-form aliases ──
    function setLight(room, isOn)        { validateRoom(room); _enqueue(`setLight("${room}", ${isOn})`,       () => apiCall("setLight",     { room, on: isOn        }).then(r => logMessage(`  ✓ ${_fmt(r, "setLight",     { room })}`)));}
    function toggleLight(room)           { validateRoom(room); _enqueue(`toggleLight("${room}")`,              () => apiCall("toggleLight",  { room                  }).then(r => logMessage(`  ✓ ${_fmt(r, "toggleLight",  { room })}`)));}
    function setFan(isOn)                { _enqueue(`setFan(${isOn})`,                     () => apiCall("setFan",       { on: Boolean(isOn)     }).then(r => logMessage(`  ✓ ${_fmt(r, "setFan",       {})}`)));}
    function setAlarm(isOn)              { _enqueue(`setAlarm(${isOn})`,                   () => apiCall("setAlarm",     { on: Boolean(isOn)     }).then(r => logMessage(`  ✓ ${_fmt(r, "setAlarm",     {})}`)));}
    function setBlinds(room, percentage) { validateRoom(room); _enqueue(`setBlinds("${room}", ${percentage})`, () => apiCall("setBlinds",    { room, percentage      }).then(r => logMessage(`  ✓ ${_fmt(r, "setBlinds",   { room })}`)));}
    function setThermostat(mode, target) { 
      if (!thermostatModes.includes(mode)) throw new Error(`Invalid mode: "${mode}". Allowed: ${thermostatModes.join(", ")}`);
      _enqueue(`setThermostat("${mode}", ${target})`, () => apiCall("setThermostat",{ mode, target          }).then(r => logMessage(`  ✓ ${_fmt(r, "setThermostat",{ mode, target })}`)));
    }

    async function runCode() {
      const code = monacoEditor.getValue();
      if (!code.trim()) return;
      clearLog(); _queue = [];
      try { 
        new Function(`\n${code}\n`)(); 
        await _drainQueue(); 
        logMessage("Done.", "ok");
      }
      catch (e) { 
        logMessage("Error: " + e.message, "err"); 
      }
    }

    function clearCode() { monacoEditor.setValue(""); }

    function toggleHelp() {
      const hp = document.getElementById("helpPanel");
      const vh = document.getElementById("viewHelpBtn");
      hp.classList.toggle("active");
      vh.style.opacity = hp.classList.contains("active") ? "0" : "1";
      vh.style.pointerEvents = hp.classList.contains("active") ? "none" : "auto";
      if (monacoEditor) setTimeout(() => monacoEditor.layout(), 50);
    }

    function convertToCode() {
      let code = `setup("${HOUSE_ID || 'your-house-id'}")\n\n`;
      program.forEach(b => {
        switch (b.action) {
          case "on":         code += `on("${b.params.room || 'living'}")\n`; break;
          case "off":        code += `off("${b.params.room || 'living'}")\n`; break;
          case "toggle":     code += `toggle("${b.params.room || 'living'}")\n`; break;
          case "fan":        code += `fan(${b.params.state === 'on'})\n`; break;
          case "alarm":      code += `alarm(${b.params.state === 'on'})\n`; break;
          case "blinds":     code += `blinds("${b.params.room || 'living'}", ${b.params.percentage || 50})\n`; break;
          case "thermostat": code += `thermostat("${b.params.mode || 'cooling'}", ${b.params.target || 65})\n`; break;
          case "wait":       code += `wait(${b.params.seconds || 1})\n`; break;
        }
      });
      monacoEditor.setValue(code); switchMode("code");
      logMessage("Blocks converted to code ✓", "info");
    }

    function initResizer() {
      const resizer = document.getElementById("resizer");
      const left = document.getElementById("left");
      const right = document.getElementById("right");
      const container = document.querySelector(".container");
      const iframe = right.querySelector("iframe");
      let isDragging = false;

      const onStart = () => { isDragging = true; resizer.classList.add("dragging"); iframe.style.pointerEvents = "none"; };
      const onEnd = () => { isDragging = false; resizer.classList.remove("dragging"); iframe.style.pointerEvents = "auto"; };
      const onMove = (e) => {
        if (!isDragging) return;
        const rect = container.getBoundingClientRect();
        const clientX = e.type.includes("touch") ? e.touches[0].clientX : e.clientX;
        const clientY = e.type.includes("touch") ? e.touches[0].clientY : e.clientY;
        if (window.innerWidth <= 960) {
          let h = ((clientY - rect.top) / rect.height) * 100;
          h = Math.max(10, Math.min(90, h));
          left.style.height = h + "%"; right.style.height = (100 - h) + "%";
        } else {
          let w = clientX - rect.left;
          w = Math.max(250, Math.min(rect.width - 250, w));
          left.style.width = w + "px";
        }
        if (monacoEditor) monacoEditor.layout();
      };
      resizer.addEventListener("mousedown", onStart); document.addEventListener("mousemove", onMove); document.addEventListener("mouseup", onEnd);
      resizer.addEventListener("touchstart", onStart); document.addEventListener("touchmove", onMove); document.addEventListener("touchend", onEnd);
    }

    require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.46.0/min/vs' } });
    require(['vs/editor/editor.main'], function () {
      monaco.editor.defineTheme('smarthouse-dark', {
        base: 'vs-dark',
        inherit: true,
        rules: [
          { token: 'comment', foreground: '4a6580', fontStyle: 'italic' },
          { token: 'keyword', foreground: '00c6ff', fontStyle: 'bold' },
          { token: 'string', foreground: '7ec8a0' },
          { token: 'number', foreground: 'ffd700' },
          { token: 'identifier', foreground: 'e0e0e0' },
        ],
        colors: {
          'editor.background': '#0d1424',
          'editor.foreground': '#e0e0e0',
          'editorLineNumber.foreground': '#3a5070',
          'editorCursor.foreground': '#00c6ff',
          'editor.selectionBackground': '#1e3a5f',
          'editor.lineHighlightBackground': '#131e30',
          'editorIndentGuide.background1': '#1e2d40',
        }
      });

      monacoEditor = monaco.editor.create(document.getElementById('monacoContainer'), {
        value: [
          '// ─── Blacksnow Code Mode ──────────────────',
          '// Commands run sequentially automatically.',
          '',
          'setup("your-house-id")',
          '',
          'on("living")',
          'wait(2)',
          'off("living")',
        ].join('\n'),
        language: 'javascript',
        theme: 'smarthouse-dark',
        fontSize: 13,
        fontFamily: "'Share Tech Mono', Consolas, monospace",
        minimap: { enabled: false },
        automaticLayout: true,
        padding: { top: 12, bottom: 12 },
      });

      monaco.languages.registerCompletionItemProvider('javascript', {
        provideCompletionItems(model, position) {
          const S = monaco.languages.CompletionItemKind.Function;
          const R = monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet;
          const suggestions = [
            { label: 'setup', kind: S, insertText: 'setup("${1:your-house-id}")', insertTextRules: R },
            { label: 'on', kind: S, insertText: 'on("${1:living}")', insertTextRules: R },
            { label: 'off', kind: S, insertText: 'off("${1:living}")', insertTextRules: R },
            { label: 'toggle', kind: S, insertText: 'toggle("${1:living}")', insertTextRules: R },
            { label: 'fan', kind: S, insertText: 'fan(${1:true})', insertTextRules: R },
            { label: 'alarm', kind: S, insertText: 'alarm(${1:true})', insertTextRules: R },
            { label: 'blinds', kind: S, insertText: 'blinds("${1:living}", ${2:50})', insertTextRules: R },
            { label: 'thermostat', kind: S, insertText: 'thermostat("${1:cooling}", ${2:65})', insertTextRules: R },
            { label: 'wait', kind: S, insertText: 'wait(${1:2})', insertTextRules: R },
          ];
          return { suggestions };
        }
      });

      monacoEditor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => runCode());
    });



    window.addEventListener('DOMContentLoaded', () => { logMessage("Ready.", "info"); initResizer(); });
  </script>
</body>
</html>